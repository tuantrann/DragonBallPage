import { GoogleLoginProvider, SocialAuthService, SocialUser } from "@abacritt/angularx-social-login";
import { HttpClient } from "@angular/common/http";
import { Component, OnInit } from '@angular/core';
import { Router } from '@angular/router';
import {MatDialog} from '@angular/material/dialog';
import { SearchDialog } from "../search-dialog/search-dialog.component";
import { SearchService } from "../shared/services/search.service";
import { map } from "rxjs";

@Component({
  selector: 'app-main-page',
  template: '<youtube-player"></youtube-player>',
  templateUrl: './main-page.component.html',
  styleUrls: ['./main-page.component.scss']
})


export class MainPageComponent implements OnInit {
  user: any;
  currentPlaying: any = false;
  currentSearching: any=false;
  screenWidth:any;
  url: any = null;
  loggedIn: boolean = true;
  isLoading: boolean = true;
  private accessToken = '';
  private fakedData: any = {
    "kind": "youtube#videoListResponse",
    "etag": "4cIPfaW_w3ob66bLpAYo07JKdFI",
    "items": [
        {
            "kind": "youtube#video",
            "etag": "9EfFHRCDfXrklSLC8FZp9wFsXLU",
            "id": "2YllmPaKhkY",
            "snippet": {
                "publishedAt": "2021-04-04T13:00:16Z",
                "channelId": "UCczPNyl3I3h8N4wK8-56VIg",
                "title": "H·∫† C√íN V∆Ø∆†NG N·∫ÆNG | DATKAA x KIDO x Prod. QT BEATZ [OFFICIAL MUSIC VIDEO]",
                "description": "#HACONVUONGNANG #DATKAA #HCVN\n                                        ==================== \n‚ñ∂Composer : DATKAA \n‚ñ∂RAP : KIDO\n‚ñ∂Music Producer : QT BEATZ\n‚ñ∂Producer/S·∫£n Xu·∫•t : DATKAA \n‚ñ∂Director & Camera : KIEN TRUNG\n‚ñ∂Design, Editor : NHON HO, DATKAA \n‚ñ∂Mix & Master : ZUKEN \n\nCh√¢n th√†nh c·∫£m ∆°n t·∫•t c·∫£ anh em ƒë√£ h·ªó tr·ª£ DatKaa trong MV l·∫ßn n√†y v√† t·∫•t c·∫£ c·∫£ b·∫°n ƒë√£ lu√¥n ƒë·ªìng h√†nh theo d√µi ·ªßng h·ªô DatKaa ƒë√¢y l√† m·ªôt ph·∫ßn qu√† l·ªùi c·∫£m ∆°n ch√¢n th√†nh ƒë·∫øn v·ªõi kh√°n gi·∫£ . H√£y c√πng t·∫≠n h∆∞·ªüng n√≥ nh√© !!!\nC·∫£m ∆°n Z studio ƒë√£ h·ªó tr·ª£ cho MV l·∫ßn n√†y \n\nZing MP3 : https://zingmp3.vn/album/Ha-Con-Vuong-Nang-Single-DatKaa/S7DF7ECF.html\n\nüîî B·∫≠t th√¥ng b√°o ƒë·ªÉ kh√¥ng b·ªè l·ª° nh·ªØng s·∫£n ph·∫©m m·ªõi nh·∫•t c·ªßa DatKaa nh√©! üîî\n\n‚ñ∫ ƒêƒÉng k√Ω k√™nh t·∫°i: https://bitly.com.vn/drhxdx\n‚ñ∫ Facebook: https://www.facebook.com/datkaa0912\n‚ñ∫ Fanpage: https://www.facebook.com/datkaaofficial1209\n‚ñ∫ Tiktok: https://www.tiktok.com/@datkaa0912\n‚ñ∫ Email li√™n h·ªá: contactdatkaa0912@gmail.com\n‚ñ∫ C·∫£m ∆°n t·∫•t c·∫£ c√°c b·∫°n ƒë√£ xem video c·ªßa ƒê·∫°t , nh·ªõ Like & ƒêƒÉng k√≠ k√™nh ·ªßng h·ªô ƒê·∫°t nh√© !!!\n‚ñ∫ M√¨nh s·∫Ω c·ªë g·∫Øng l√†m ra nh·ªØng video ch·∫•t l∆∞·ª£ng v√† t√≠nh gi·∫£i tr√≠ nh·∫•t c√≥ th·ªÉ cho c√°c m·ªçi ng∆∞·ªùi . Y√™u C√°c M·ªçi Ng∆∞·ªùi !!!\n---------------------/---------------------\n¬© B·∫£n quy·ªÅn thu·ªôc v·ªÅ DatKaa - Vui l√≤ng KH√îNG REMIX, COVER, REUP d∆∞·ªõi m·ªçi h√¨nh th·ª©c",
                "thumbnails": {
                    "default": {
                        "url": "https://i.ytimg.com/vi/2YllmPaKhkY/default.jpg",
                        "width": 120,
                        "height": 90
                    },
                    "medium": {
                        "url": "https://i.ytimg.com/vi/2YllmPaKhkY/mqdefault.jpg",
                        "width": 320,
                        "height": 180
                    },
                    "high": {
                        "url": "https://i.ytimg.com/vi/2YllmPaKhkY/hqdefault.jpg",
                        "width": 480,
                        "height": 360
                    },
                    "standard": {
                        "url": "https://i.ytimg.com/vi/2YllmPaKhkY/sddefault.jpg",
                        "width": 640,
                        "height": 480
                    },
                    "maxres": {
                        "url": "https://i.ytimg.com/vi/2YllmPaKhkY/maxresdefault.jpg",
                        "width": 1280,
                        "height": 720
                    }
                },
                "channelTitle": "DatKaa Official",
                "tags": [
                    "h·∫° c√≤n v∆∞∆°ng n·∫Øng",
                    "ha con vuong nang",
                    "h·∫° c√≤n v∆∞∆°ng n·∫Øng cover",
                    "h·∫° c√≤n v∆∞∆°ng n·∫Øng remix",
                    "h·∫° c√≤n v∆∞∆°ng n·∫Øng karaoke",
                    "h·∫° c√≤n v∆∞∆°ng n·∫Øng lyrics",
                    "h·∫° c√≤n v∆∞∆°ng n·∫Øng 1 hours",
                    "h·∫° c√≤n v∆∞∆°ng n·∫Øng datkaa",
                    "datkaa h·∫° c√≤n v∆∞∆°ng n·∫Øng",
                    "h·∫° c√≤n v∆∞∆°ng n·∫Øng kido",
                    "h·∫° c√≤n v∆∞∆°ng n·∫Øng qt beatz",
                    "h·∫° c√≤n v∆∞∆°ng n·∫Øng mv",
                    "h·∫° c√≤n v∆∞∆°ng n·∫Øng music",
                    "h·∫° c√≤n v∆∞∆°ng n·∫Øng video",
                    "h·∫° c√≤n v∆∞∆°ng n·∫Øng music video",
                    "datkaa",
                    "ƒë·∫°t kaa",
                    "dat kaa",
                    "datkaa official",
                    "nguy·ªÖn t·∫•n ƒë·∫°t",
                    "hcvn",
                    "datkaa tiktok",
                    "#hcvn",
                    "#datkaa"
                ],
                "categoryId": "10",
                "liveBroadcastContent": "none",
                "localized": {
                    "title": "H·∫† C√íN V∆Ø∆†NG N·∫ÆNG | DATKAA x KIDO x Prod. QT BEATZ [OFFICIAL MUSIC VIDEO]",
                    "description": "#HACONVUONGNANG #DATKAA #HCVN\n                                        ==================== \n‚ñ∂Composer : DATKAA \n‚ñ∂RAP : KIDO\n‚ñ∂Music Producer : QT BEATZ\n‚ñ∂Producer/S·∫£n Xu·∫•t : DATKAA \n‚ñ∂Director & Camera : KIEN TRUNG\n‚ñ∂Design, Editor : NHON HO, DATKAA \n‚ñ∂Mix & Master : ZUKEN \n\nCh√¢n th√†nh c·∫£m ∆°n t·∫•t c·∫£ anh em ƒë√£ h·ªó tr·ª£ DatKaa trong MV l·∫ßn n√†y v√† t·∫•t c·∫£ c·∫£ b·∫°n ƒë√£ lu√¥n ƒë·ªìng h√†nh theo d√µi ·ªßng h·ªô DatKaa ƒë√¢y l√† m·ªôt ph·∫ßn qu√† l·ªùi c·∫£m ∆°n ch√¢n th√†nh ƒë·∫øn v·ªõi kh√°n gi·∫£ . H√£y c√πng t·∫≠n h∆∞·ªüng n√≥ nh√© !!!\nC·∫£m ∆°n Z studio ƒë√£ h·ªó tr·ª£ cho MV l·∫ßn n√†y \n\nZing MP3 : https://zingmp3.vn/album/Ha-Con-Vuong-Nang-Single-DatKaa/S7DF7ECF.html\n\nüîî B·∫≠t th√¥ng b√°o ƒë·ªÉ kh√¥ng b·ªè l·ª° nh·ªØng s·∫£n ph·∫©m m·ªõi nh·∫•t c·ªßa DatKaa nh√©! üîî\n\n‚ñ∫ ƒêƒÉng k√Ω k√™nh t·∫°i: https://bitly.com.vn/drhxdx\n‚ñ∫ Facebook: https://www.facebook.com/datkaa0912\n‚ñ∫ Fanpage: https://www.facebook.com/datkaaofficial1209\n‚ñ∫ Tiktok: https://www.tiktok.com/@datkaa0912\n‚ñ∫ Email li√™n h·ªá: contactdatkaa0912@gmail.com\n‚ñ∫ C·∫£m ∆°n t·∫•t c·∫£ c√°c b·∫°n ƒë√£ xem video c·ªßa ƒê·∫°t , nh·ªõ Like & ƒêƒÉng k√≠ k√™nh ·ªßng h·ªô ƒê·∫°t nh√© !!!\n‚ñ∫ M√¨nh s·∫Ω c·ªë g·∫Øng l√†m ra nh·ªØng video ch·∫•t l∆∞·ª£ng v√† t√≠nh gi·∫£i tr√≠ nh·∫•t c√≥ th·ªÉ cho c√°c m·ªçi ng∆∞·ªùi . Y√™u C√°c M·ªçi Ng∆∞·ªùi !!!\n---------------------/---------------------\n¬© B·∫£n quy·ªÅn thu·ªôc v·ªÅ DatKaa - Vui l√≤ng KH√îNG REMIX, COVER, REUP d∆∞·ªõi m·ªçi h√¨nh th·ª©c"
                },
                "defaultAudioLanguage": "vi"
            },
            "contentDetails": {
                "duration": "PT4M52S",
                "dimension": "2d",
                "definition": "hd",
                "caption": "true",
                "licensedContent": true,
                "contentRating": {},
                "projection": "rectangular"
            },
            "statistics": {
                "viewCount": "74599236",
                "likeCount": "400546",
                "favoriteCount": "0",
                "commentCount": "14480"
            }
        },
        {
            "kind": "youtube#video",
            "etag": "zA5rVR9vvcd41FE01CTK_B4BnbU",
            "id": "7kJkNDjgOE4",
            "snippet": {
                "publishedAt": "2022-12-03T12:55:10Z",
                "channelId": "UCqCkDxuA74VmDk73txol5iQ",
                "title": "CH√ÄNG TRAI C·ª¶A EM - DUY VƒÇN PH·∫†M | OFFICIAL MUSIC VIDEO",
                "description": "CH√ÄNG TRAI C·ª¶A EM - DUY VƒÇN PH·∫†M | OFFICIAL MUSIC VIDEO\n#changtraicuaem\n#duyvanpham\n#acventertainment\n\nCredit MV Official \n\nProduction Manager : L√™ C∆∞∆°ng\nDirector of Communications : B√πi Trung Hi·∫øu\nSingers & Composer: Duy Van Pham \nMain Actress: H√°ch Li√™n T·ª≠ Nguy·ªát\nRecording: Nguy·ªÖn Nh∆∞ Vi·ªát \nMix and Mastering: L√™ Tr∆∞·ªùng V≈©\nMusic Producer: Minh khoa\nScript Writer & Director: C·∫£nh Cu·ªôi  \nProject Assistant: Mai Phan\nEditor: L·ª•c Qu·ªëc Huy  \nColor Grading: L√™ Thanh T√πng - Nguy·ªÖn Ti·∫øn \nCamera Operator: Tung Le - Pong \nPhotographer: Healer Nguyen - Nguy·ªÖn Ho√†ng Ph√∫c \nDesigner: Pong  \nStylist: D∆∞∆°ng Ng\nStarring: Tr·∫ßn Ho√†ng S∆°n - Tr·∫ßn ƒê·∫°t - L∆∞u VƒÉn T√¢n - B√πi Th·ªã Qu·ª≥nh H∆∞∆°ng - Nguyen Ngoc Anh\n\n\nLyric : \nM·ªõi h∆°n hai m∆∞∆°i tu·ªïi\nV√† c≈©ng ch·∫≥ng c√≥ g√¨ trong tay\nS√°ng xu·∫•t x√¥i l·∫°c, tr∆∞a v·ªÅ l√†m th√™m g√≥i m√¨\nNh√† anh th√¨ c·∫•p b·ªën\nXe anh th√¨ ƒëi wave t√†u\nNh√¨n anh kh√¥ng bi·∫øt em c√≥ ch·ªãu th∆∞∆°ng kh√¥ng\nAnh ƒë√¢y th√¨ v·∫´n ·∫ø\nXe anh v·∫´n th·ª´a y√™n sau\nN·∫øu th√≠ch ƒëi xa em ch·ªâ c·∫ßn alo anh t·ªõi t·∫≠n nh√†\nAnh ch·∫≥ng ph·∫£i si√™u nh√¢n\nCh·ª© anh th√¨ lu√¥n s·∫µn s√†ng\nQuy·∫øt t√¢m, b·∫£o v·ªá cho em\n\nƒêk : \nAnh s·∫Ω l√† m·ªôt ch√†ng trai \nLu√¥n mang v√°c t∆∞∆°ng lai cho em\nEm s·∫Ω l√† m·ªôt c√¥ g√°i\nLu√¥n b√¨nh an gi·ªØa nh·ªØng b·ªô b·ªÅ\nBa m·∫π em kh√≥ t√≠nh\nTh√¨ ba m·∫π anh c≈©ng ch·∫≥ng v·ª´a\nH·∫°nh ph√∫c ƒëi l√™n t·ª´ nh·ªØng ƒëi·ªÅu b√© th√¥i\n\nN·∫Øm tay qua m·ªçi gian kh√≥\nS√°nh b∆∞·ªõc tr√™n con ƒë∆∞·ªùng d√†i\nAnh s·∫Ω lu√¥n th·∫≠t c·ªë g·∫Øng\nTa c√πng nhau ƒë·∫Øp x√¢y t∆∞∆°ng lai\nƒê·ª´ng b·∫≠n t√¢m chi n·ªØa\nC√¥ ƒë∆°n v·∫≠y ƒë·ªß r·ªìi\nGi·ªù ƒë√£, c√≥ anh ƒë√¢y r·ªìi\n\nNh∆∞ng m√† l·ª° y√™u r·ªìi \nTh√¨ l√†m sao l·∫°i ph·∫£i gi·∫•u\nCh·∫≥ng ph·∫£i ƒë·∫±ng ·∫•y c≈©ng ƒëang b∆° v∆° m·ªôt m√¨nh hay sao\nCh·∫≥ng c·∫ßn em ƒë·ªìng √Ω\nTh√¨ anh ƒë√¢y v·∫´n c·ª© ƒë√¢m ƒë·∫ßu\nT√¨nh y√™u th√¨ ƒë√¢u c·∫ßn c√≥ l√≠ do\n\nLi√™n h·ªá c√¥ng vi·ªác:\n‚Ä¢ Booking :\n‚úÜ 0968.191.333 (Mr Nghƒ©a)\n‚Ä¢ Facebook: https://www.facebook.com/nghiaacvmusic\n‚Ä¢ Email: Bookingacv@gmail.com\n\n‚ñ∫ N·∫øu c√≥ b·∫•t k·ª≥ v·∫•n ƒë·ªÅ n√†o li√™n quan ƒë·∫øn b·∫£n quy·ªÅn trong video, xin vui l√≤ng li√™n h·ªá: banquyen@acventertainment.com\n--------\nfollow Duy VƒÉn Ph·∫°m: \nFACEBOOK: https://www.facebook.com/vanpham.duy.109\nTIKTOK: https://www.tiktok.com/@_duyvanpham99\n--------------------------------------------------------------/-------------------\n¬© B·∫£n quy·ªÅn  Duy VƒÉn Ph·∫°m Official Official\n¬© Copyright by  Duy VƒÉn Ph·∫°m Official & ACV Entertainment ‚òû Do not Reup",
                "thumbnails": {
                    "default": {
                        "url": "https://i.ytimg.com/vi/7kJkNDjgOE4/default.jpg",
                        "width": 120,
                        "height": 90
                    },
                    "medium": {
                        "url": "https://i.ytimg.com/vi/7kJkNDjgOE4/mqdefault.jpg",
                        "width": 320,
                        "height": 180
                    },
                    "high": {
                        "url": "https://i.ytimg.com/vi/7kJkNDjgOE4/hqdefault.jpg",
                        "width": 480,
                        "height": 360
                    },
                    "standard": {
                        "url": "https://i.ytimg.com/vi/7kJkNDjgOE4/sddefault.jpg",
                        "width": 640,
                        "height": 480
                    },
                    "maxres": {
                        "url": "https://i.ytimg.com/vi/7kJkNDjgOE4/maxresdefault.jpg",
                        "width": 1280,
                        "height": 720
                    }
                },
                "channelTitle": "Duy VƒÉn Ph·∫°m Official",
                "tags": [
                    "duy vƒÉn ph·∫°m",
                    "duy vƒÉn ph·∫°m tiktok",
                    "duyvanpham tiktok",
                    "ph·∫°m vƒÉn duy tiktok",
                    "duyvanpham official",
                    "duyvanpham99",
                    "duyvanpham",
                    "duy van pham",
                    "duy vƒÉn ph·∫°m tik tok",
                    "ch√†ng trai c·ªßa em duy vƒÉn ph·∫°m",
                    "ch√†ng trai c·ªßa em mv",
                    "ch√†ng trai c·ªßa em hot tiktok",
                    "ch√†ng trai c·ªßa em",
                    "anh s·∫Ω l√† m·ªôt ch√†ng trai",
                    "anh s·∫Ω l√† m·ªôt ch√†ng trai lu√¥n mang v√°c t∆∞∆°ng lai cho em"
                ],
                "categoryId": "10",
                "liveBroadcastContent": "none",
                "localized": {
                    "title": "CH√ÄNG TRAI C·ª¶A EM - DUY VƒÇN PH·∫†M | OFFICIAL MUSIC VIDEO",
                    "description": "CH√ÄNG TRAI C·ª¶A EM - DUY VƒÇN PH·∫†M | OFFICIAL MUSIC VIDEO\n#changtraicuaem\n#duyvanpham\n#acventertainment\n\nCredit MV Official \n\nProduction Manager : L√™ C∆∞∆°ng\nDirector of Communications : B√πi Trung Hi·∫øu\nSingers & Composer: Duy Van Pham \nMain Actress: H√°ch Li√™n T·ª≠ Nguy·ªát\nRecording: Nguy·ªÖn Nh∆∞ Vi·ªát \nMix and Mastering: L√™ Tr∆∞·ªùng V≈©\nMusic Producer: Minh khoa\nScript Writer & Director: C·∫£nh Cu·ªôi  \nProject Assistant: Mai Phan\nEditor: L·ª•c Qu·ªëc Huy  \nColor Grading: L√™ Thanh T√πng - Nguy·ªÖn Ti·∫øn \nCamera Operator: Tung Le - Pong \nPhotographer: Healer Nguyen - Nguy·ªÖn Ho√†ng Ph√∫c \nDesigner: Pong  \nStylist: D∆∞∆°ng Ng\nStarring: Tr·∫ßn Ho√†ng S∆°n - Tr·∫ßn ƒê·∫°t - L∆∞u VƒÉn T√¢n - B√πi Th·ªã Qu·ª≥nh H∆∞∆°ng - Nguyen Ngoc Anh\n\n\nLyric : \nM·ªõi h∆°n hai m∆∞∆°i tu·ªïi\nV√† c≈©ng ch·∫≥ng c√≥ g√¨ trong tay\nS√°ng xu·∫•t x√¥i l·∫°c, tr∆∞a v·ªÅ l√†m th√™m g√≥i m√¨\nNh√† anh th√¨ c·∫•p b·ªën\nXe anh th√¨ ƒëi wave t√†u\nNh√¨n anh kh√¥ng bi·∫øt em c√≥ ch·ªãu th∆∞∆°ng kh√¥ng\nAnh ƒë√¢y th√¨ v·∫´n ·∫ø\nXe anh v·∫´n th·ª´a y√™n sau\nN·∫øu th√≠ch ƒëi xa em ch·ªâ c·∫ßn alo anh t·ªõi t·∫≠n nh√†\nAnh ch·∫≥ng ph·∫£i si√™u nh√¢n\nCh·ª© anh th√¨ lu√¥n s·∫µn s√†ng\nQuy·∫øt t√¢m, b·∫£o v·ªá cho em\n\nƒêk : \nAnh s·∫Ω l√† m·ªôt ch√†ng trai \nLu√¥n mang v√°c t∆∞∆°ng lai cho em\nEm s·∫Ω l√† m·ªôt c√¥ g√°i\nLu√¥n b√¨nh an gi·ªØa nh·ªØng b·ªô b·ªÅ\nBa m·∫π em kh√≥ t√≠nh\nTh√¨ ba m·∫π anh c≈©ng ch·∫≥ng v·ª´a\nH·∫°nh ph√∫c ƒëi l√™n t·ª´ nh·ªØng ƒëi·ªÅu b√© th√¥i\n\nN·∫Øm tay qua m·ªçi gian kh√≥\nS√°nh b∆∞·ªõc tr√™n con ƒë∆∞·ªùng d√†i\nAnh s·∫Ω lu√¥n th·∫≠t c·ªë g·∫Øng\nTa c√πng nhau ƒë·∫Øp x√¢y t∆∞∆°ng lai\nƒê·ª´ng b·∫≠n t√¢m chi n·ªØa\nC√¥ ƒë∆°n v·∫≠y ƒë·ªß r·ªìi\nGi·ªù ƒë√£, c√≥ anh ƒë√¢y r·ªìi\n\nNh∆∞ng m√† l·ª° y√™u r·ªìi \nTh√¨ l√†m sao l·∫°i ph·∫£i gi·∫•u\nCh·∫≥ng ph·∫£i ƒë·∫±ng ·∫•y c≈©ng ƒëang b∆° v∆° m·ªôt m√¨nh hay sao\nCh·∫≥ng c·∫ßn em ƒë·ªìng √Ω\nTh√¨ anh ƒë√¢y v·∫´n c·ª© ƒë√¢m ƒë·∫ßu\nT√¨nh y√™u th√¨ ƒë√¢u c·∫ßn c√≥ l√≠ do\n\nLi√™n h·ªá c√¥ng vi·ªác:\n‚Ä¢ Booking :\n‚úÜ 0968.191.333 (Mr Nghƒ©a)\n‚Ä¢ Facebook: https://www.facebook.com/nghiaacvmusic\n‚Ä¢ Email: Bookingacv@gmail.com\n\n‚ñ∫ N·∫øu c√≥ b·∫•t k·ª≥ v·∫•n ƒë·ªÅ n√†o li√™n quan ƒë·∫øn b·∫£n quy·ªÅn trong video, xin vui l√≤ng li√™n h·ªá: banquyen@acventertainment.com\n--------\nfollow Duy VƒÉn Ph·∫°m: \nFACEBOOK: https://www.facebook.com/vanpham.duy.109\nTIKTOK: https://www.tiktok.com/@_duyvanpham99\n--------------------------------------------------------------/-------------------\n¬© B·∫£n quy·ªÅn  Duy VƒÉn Ph·∫°m Official Official\n¬© Copyright by  Duy VƒÉn Ph·∫°m Official & ACV Entertainment ‚òû Do not Reup"
                },
                "defaultAudioLanguage": "vi"
            },
            "contentDetails": {
                "duration": "PT3M49S",
                "dimension": "2d",
                "definition": "hd",
                "caption": "false",
                "licensedContent": true,
                "contentRating": {},
                "projection": "rectangular"
            },
            "statistics": {
                "viewCount": "722171",
                "likeCount": "15336",
                "favoriteCount": "0",
                "commentCount": "654"
            }
        },
        {
            "kind": "youtube#video",
            "etag": "QSjyAa5z1VlzC2VLA6UA1JGwK3U",
            "id": "jLWoIe-s9bM",
            "snippet": {
                "publishedAt": "2014-03-08T03:30:44Z",
                "channelId": "UCS1uVHwpLHQfxPP6nSi8sOw",
                "title": "Ho·∫°t c·∫£nh Hai B√† Tr∆∞ng - 8A9 2012-2013",
                "description": "",
                "thumbnails": {
                    "default": {
                        "url": "https://i.ytimg.com/vi/jLWoIe-s9bM/default.jpg",
                        "width": 120,
                        "height": 90
                    },
                    "medium": {
                        "url": "https://i.ytimg.com/vi/jLWoIe-s9bM/mqdefault.jpg",
                        "width": 320,
                        "height": 180
                    },
                    "high": {
                        "url": "https://i.ytimg.com/vi/jLWoIe-s9bM/hqdefault.jpg",
                        "width": 480,
                        "height": 360
                    },
                    "standard": {
                        "url": "https://i.ytimg.com/vi/jLWoIe-s9bM/sddefault.jpg",
                        "width": 640,
                        "height": 480
                    },
                    "maxres": {
                        "url": "https://i.ytimg.com/vi/jLWoIe-s9bM/maxresdefault.jpg",
                        "width": 1280,
                        "height": 720
                    }
                },
                "channelTitle": "Lisa Vu",
                "tags": [
                    "HBT",
                    "Hai B√† Tr∆∞ng",
                    "8a9",
                    "9a9"
                ],
                "categoryId": "10",
                "liveBroadcastContent": "none",
                "localized": {
                    "title": "Ho·∫°t c·∫£nh Hai B√† Tr∆∞ng - 8A9 2012-2013",
                    "description": ""
                }
            },
            "contentDetails": {
                "duration": "PT16M38S",
                "dimension": "2d",
                "definition": "sd",
                "caption": "false",
                "licensedContent": false,
                "contentRating": {},
                "projection": "rectangular"
            },
            "statistics": {
                "viewCount": "1291",
                "likeCount": "5",
                "favoriteCount": "0",
                "commentCount": "0"
            }
        },
        {
            "kind": "youtube#video",
            "etag": "z_9bM1L5tviXGQTHwp4tOCK6Ow4",
            "id": "QT7w5DHUjT8",
            "snippet": {
                "publishedAt": "2022-09-10T18:35:09Z",
                "channelId": "UC0jfkb8bHxx3Y0MbSmx7QyQ",
                "title": "My morning routine Patrick Bateman style",
                "description": "",
                "thumbnails": {
                    "default": {
                        "url": "https://i.ytimg.com/vi/QT7w5DHUjT8/default.jpg",
                        "width": 120,
                        "height": 90
                    },
                    "medium": {
                        "url": "https://i.ytimg.com/vi/QT7w5DHUjT8/mqdefault.jpg",
                        "width": 320,
                        "height": 180
                    },
                    "high": {
                        "url": "https://i.ytimg.com/vi/QT7w5DHUjT8/hqdefault.jpg",
                        "width": 480,
                        "height": 360
                    },
                    "standard": {
                        "url": "https://i.ytimg.com/vi/QT7w5DHUjT8/sddefault.jpg",
                        "width": 640,
                        "height": 480
                    }
                },
                "channelTitle": "Michael Hoover",
                "categoryId": "24",
                "liveBroadcastContent": "none",
                "localized": {
                    "title": "My morning routine Patrick Bateman style",
                    "description": ""
                }
            },
            "contentDetails": {
                "duration": "PT30S",
                "dimension": "2d",
                "definition": "hd",
                "caption": "false",
                "licensedContent": false,
                "contentRating": {},
                "projection": "rectangular"
            },
            "statistics": {
                "viewCount": "5829185",
                "likeCount": "311270",
                "favoriteCount": "0",
                "commentCount": "2182"
            }
        },
        {
            "kind": "youtube#video",
            "etag": "R0KgVcxb7R60uNQT61bNGwuqqaE",
            "id": "u91DkNXc8ws",
            "snippet": {
                "publishedAt": "2022-06-10T12:40:53Z",
                "channelId": "UCwqCjp1MtLcMwymqd7qFihA",
                "title": "Nh·ªØng T√¨nh Hu·ªëng Giao Ti·∫øp N4 Kh√¥ng Th·ªÉ B·ªè qua | ÂàùÁ¥öÊó•Êú¨Ë™û‰ºöË©± | Japanese Conversation N4",
                "description": "#hienminhjp #japaneseconversation #nihongokaiwa #n4kaiwa\nLearn more here: https://www.mlcjapanese.co.jp/\nH√£y nghe th·∫≠t nhi·ªÅu nh·ªØng t√¨nh hu·ªëng giao ti·∫øp h√†ng ng√†y nh∆∞ video d∆∞·ªõi ƒë√¢y, b·∫°n s·∫Ω ng·∫°c nhi√™n v√¨ kh·∫£ nƒÉng ph·∫£n x·∫° giao ti·∫øp c·∫£i thi·ªán r√µ r·ªát ƒë√≥!",
                "thumbnails": {
                    "default": {
                        "url": "https://i.ytimg.com/vi/u91DkNXc8ws/default.jpg",
                        "width": 120,
                        "height": 90
                    },
                    "medium": {
                        "url": "https://i.ytimg.com/vi/u91DkNXc8ws/mqdefault.jpg",
                        "width": 320,
                        "height": 180
                    },
                    "high": {
                        "url": "https://i.ytimg.com/vi/u91DkNXc8ws/hqdefault.jpg",
                        "width": 480,
                        "height": 360
                    },
                    "standard": {
                        "url": "https://i.ytimg.com/vi/u91DkNXc8ws/sddefault.jpg",
                        "width": 640,
                        "height": 480
                    }
                },
                "channelTitle": "Hien Minh JP",
                "categoryId": "27",
                "liveBroadcastContent": "none",
                "localized": {
                    "title": "Nh·ªØng T√¨nh Hu·ªëng Giao Ti·∫øp N4 Kh√¥ng Th·ªÉ B·ªè qua | ÂàùÁ¥öÊó•Êú¨Ë™û‰ºöË©± | Japanese Conversation N4",
                    "description": "#hienminhjp #japaneseconversation #nihongokaiwa #n4kaiwa\nLearn more here: https://www.mlcjapanese.co.jp/\nH√£y nghe th·∫≠t nhi·ªÅu nh·ªØng t√¨nh hu·ªëng giao ti·∫øp h√†ng ng√†y nh∆∞ video d∆∞·ªõi ƒë√¢y, b·∫°n s·∫Ω ng·∫°c nhi√™n v√¨ kh·∫£ nƒÉng ph·∫£n x·∫° giao ti·∫øp c·∫£i thi·ªán r√µ r·ªát ƒë√≥!"
                }
            },
            "contentDetails": {
                "duration": "PT34M7S",
                "dimension": "2d",
                "definition": "hd",
                "caption": "false",
                "licensedContent": true,
                "contentRating": {},
                "projection": "rectangular"
            },
            "statistics": {
                "viewCount": "12594",
                "likeCount": "222",
                "favoriteCount": "0",
                "commentCount": "11"
            }
        }
    ],
    "nextPageToken": "CAUQAA",
    "pageInfo": {
        "totalResults": 152,
        "resultsPerPage": 5
    }
  }
  likedVideos: any;
  popularVideos: any;
  sliderArray: any = [];
  popularMusicArray: any = [];
  searchVideosArray: any = [];
  inputValue: any = '';

  constructor(private router: Router, 
      private authService: SocialAuthService,
      private httpClient: HttpClient,
      public dialog: MatDialog,
      private searchService: SearchService
    ) { }

  async getAccessToken() {
    await this.authService.getAccessToken(GoogleLoginProvider.PROVIDER_ID).then( (temp) => {
      this.accessToken = temp
      this.getLikedVideos()
      this.getPopularMusicVideo()
    }
      
    );
  }

  playThis(song: any)
  {
    this.url = song;
    this.currentSearching = false;
    this.currentPlaying = true;
    
  }

  ngOnInit(): void {
    const tag = document.createElement('script');
    this.screenWidth = window.innerWidth-10;  
    if(this.screenWidth>600)
    {
      this.screenWidth=600;
    }
    tag.src = 'https://www.youtube.com/iframe_api';
    document.body.appendChild(tag);

    this.authService.authState.subscribe((user) => { 
      this.user = user;
      this.loggedIn = (user != null);
      if(this.loggedIn)
        {
          this.getAccessToken()
        }

    });
    
  }

  openDialog()
  {
    const dialogRef = this.dialog.open(SearchDialog, {
      width: '300px'
    });
    dialogRef.afterClosed().subscribe(result => {
    });
  }

  refreshToken(): void {
    this.authService.refreshAuthToken(GoogleLoginProvider.PROVIDER_ID);
  }


  getLikedVideos(): void {
    this.isLoading = true;
    if(!this.accessToken) return;
    this.httpClient
    .get('https://www.googleapis.com/youtube/v3/videos?part=snippet%2CcontentDetails%2Cstatistics&myRating=like&maxResults=10'
    ,{headers: {Authorization: `Bearer ${this.accessToken}`,Accept: `application/json`}}
    ).pipe(
        map((response: any) => response.items)
      )
    .subscribe((items: any) => 
    {
      
      this.sliderArray = items.map((item: any) => {
          return {
            title: item.snippet.title,
            id: item.id.videoId,
            channel: item.snippet.channelTitle,
            published: new Date(item.snippet.publishedAt),
            img: item.snippet.thumbnails.high.url
          };
        });


      setTimeout(() => 
      {
        this.isLoading = false;
      }, 5000)
 
    })
  }

  getPopularMusicVideo(): void {
    if(!this.accessToken) return;
    this.httpClient
    .get('https://www.googleapis.com/youtube/v3/videos?part=snippet%2CcontentDetails%2Cstatistics&chart=mostPopular&regionCode=VN&videoCategoryId=10&maxResults=2'
    ,{headers: {Authorization: `Bearer ${this.accessToken}`,Accept: `application/json`}}
    ).pipe(
        map((response: any) => response.items)
      )
    .subscribe((items:any) => 
    {
      this.popularMusicArray = items.map((item: any) => {
          return {
            title: item.snippet.title,
            id: item.id.videoId,
            channel: item.snippet.channelTitle,
            published: new Date(item.snippet.publishedAt),
            img: item.snippet.thumbnails.high.url
          };
        });
 
    })
  }

  searchVideos()
  {
    this.searchService.getVideos(this.inputValue)
      .subscribe((items : any) => {
        this.searchVideosArray = items.map((item: any) => {
          return {
            title: item.snippet.title,
            id: item.id.videoId,
            channel: item.snippet.channelTitle,
            published: new Date(item.snippet.publishedAt),
            img: item.snippet.thumbnails.high.url
          };
        });
      });

    this.currentSearching = true
  }

}
